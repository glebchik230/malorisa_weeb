<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Админ-панель</title>
  <style>
    body{margin:0;font-family:'Segoe UI',sans-serif;background:#f9f0f7;padding:20px}
    .box{background:#fff;padding:20px;border-radius:12px;box-shadow:0 0 15px rgba(0,0,0,0.1);max-width:500px;margin:auto}
    select,input,textarea{width:100%;margin:8px 0;padding:10px;border:1px solid #ccc;border-radius:8px;box-sizing:border-box}
    button{padding:10px;background:#cc6699;color:#fff;border:none;border-radius:8px;cursor:pointer}
    button:hover{background:#b35588}
    .back{margin-top:12px}
    .back a{color:#999;text-decoration:none}
  </style>
</head>
<body>
  <div class="box">
    <h2>Админ-панель</h2>
    <select id="sel"><option>Выберите...</option></select>
    <select id="type"><option value="Похвала">Похвала</option><option value="Выговор">Выговор</option></select>
    <textarea id="msg" rows="3" placeholder="Текст уведомления"></textarea>
    <button onclick="send()">Отправить</button>
    <div class="back"><a href="profile.html">← Назад</a></div>
  </div>
  <script>
    const u=JSON.parse(localStorage.getItem('user'));
    if(!u||u.role!=='admin'){location.href='login.html'}

    const sel=document.getElementById('sel');
    function upd(){
      sel.innerHTML='<option>Выберите...</option>';
      JSON.parse(localStorage.getItem('users')||'[]').forEach(us=>{
        sel.innerHTML+=`<option value="${us.phone}">${us.name} (${us.phone})</option>`;
      });
    }
    upd();

    function send(){
      const ph=sel.value;
      const tp=document.getElementById('type').value;
      const txt=document.getElementById('msg').value.trim();
      if(ph==='Выберите...'||!txt){alert('Заполните!');return;}
      const uss=JSON.parse(localStorage.getItem('users')||'[]');
      const idx=uss.findIndex(x=>x.phone===ph);
      const item=uss[idx];
      const delta = tp==='Похвала'?1:-1;
      item.rating = (item.rating||0) + delta;
      item.notifications = item.notifications||[];
      item.notifications.push(`${tp}: ${txt}`);
      uss[idx]=item;
      localStorage.setItem('users',JSON.stringify(uss));
      alert('Отправлено');
    }
  </script>
</body>
</html>



